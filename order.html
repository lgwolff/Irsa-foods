<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Irsa Foods - Order</title>
<link rel="stylesheet" href="css/style.css">
<style>
  *{box-sizing:border-box;margin:0;padding:0;font-family:Arial,sans-serif;}
  body{background:#fff;color:#212121;}
  header, footer{background:#212121;color:#fff;padding:15px;text-align:center;}
  header a, footer a{color:#F25C54;text-decoration:none;margin:0 5px;}
  main{padding:20px;}
  .cart-table{width:100%;border-collapse:collapse;margin-bottom:20px;}
  .cart-table th, .cart-table td{border:1px solid #eee;padding:10px;text-align:center;}
  .quantity-btn{padding:2px 8px;margin:0 5px;cursor:pointer;}
  .summary{margin-top:15px;font-size:18px;}
  .btn-order{display:inline-block;margin-top:10px;padding:10px 20px;background:#D90416;color:#fff;border:none;border-radius:5px;cursor:pointer;}
  .btn-order:hover{background:#F25C54;}
</style>
</head>
<body>

<header>
  <h1>Irsa Foods - Order</h1>
</header>

<main>

<table class="cart-table" id="cart-table">
  <thead>
    <tr>
      <th>Product</th>
      <th>Price</th>
      <th>Qty</th>
      <th>Total</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<div class="summary" id="summary"></div>

<form action="https://formsubmit.co/irslantariq59@gmail.com" method="POST" onsubmit="prepareOrder()">

  <!-- FormSubmit controls -->
  <input type="hidden" name="_subject" value="New Order - Irsa Foods">
  <input type="hidden" name="_captcha" value="false">
  <input type="hidden" name="_template" value="table">

  <!-- Order payload -->
  <input type="hidden" name="Order Number" id="order_number">
  <input type="hidden" name="Order Details" id="order_details">
  <input type="hidden" name="Grand Total" id="grand_total">

  <!-- Customer inputs -->
  <input type="text" name="Customer Name" id="name" placeholder="Your Name" required><br><br>
  <input type="tel" name="Phone Number" id="phone" placeholder="Your WhatsApp Number" required><br><br>
  <input type="text" name="Delivery Address" id="address" placeholder="Delivery Address" required><br><br>

  <button type="submit" class="btn-order">Place Order</button>
</form>

</main>

<footer>
  <p>Contact us: +923177910929</p>
</footer>

<script>
// PRODUCTS
const products = [
  {id:1,name:"BelVita Biscuits",price:150},
  {id:2,name:"Lip Gloss",price:250}
];

let cart = [];

// CART FUNCTIONS
function addToCart(id){
  const p = products.find(x=>x.id===id);
  const c = cart.find(x=>x.id===id);
  if(c){ c.qty++; c.total=c.qty*c.price; }
  else{ cart.push({...p,qty:1,total:p.price}); }
  renderCart();
}

function removeFromCart(id){
  cart = cart.filter(x=>x.id!==id);
  renderCart();
}

function changeQty(id,d){
  const c = cart.find(x=>x.id===id);
  if(!c) return;
  c.qty += d;
  if(c.qty<1) c.qty=1;
  c.total=c.qty*c.price;
  renderCart();
}

function renderCart(){
  const tb=document.querySelector('#cart-table tbody');
  tb.innerHTML='';
  cart.forEach(i=>{
    tb.innerHTML+=`
      <tr>
        <td>${i.name}</td>
        <td>PKR ${i.price}</td>
        <td>${i.qty}</td>
        <td>PKR ${i.total}</td>
        <td>
          <button class="quantity-btn" onclick="changeQty(${i.id},1)">+</button>
          <button class="quantity-btn" onclick="changeQty(${i.id},-1)">-</button>
          <button class="quantity-btn" onclick="removeFromCart(${i.id})">Remove</button>
        </td>
      </tr>`;
  });
  updateSummary();
}

function updateSummary(){
  const delivery=299, upfront=200, codRate=0.07;
  const productsTotal=cart.reduce((s,c)=>s+c.total,0);
  const cod=Math.round((productsTotal+delivery)*codRate);
  const grand=productsTotal+delivery+cod-upfront;
  document.getElementById('summary').innerHTML=`
    Products Total: PKR ${productsTotal}<br>
    Delivery Fee: PKR ${delivery}<br>
    COD Fee (7%): PKR ${cod}<br>
    Upfront Fee: PKR ${upfront}<br>
    <strong>Grand Total: PKR ${grand}</strong>`;
}

function prepareOrder(){
  if(cart.length===0){
    alert("Cart is empty");
    event.preventDefault();
    return;
  }

  const orderNo = "IRSA-" + Date.now();
  let details = cart.map(i =>
    `${i.name} x ${i.qty} = PKR ${i.total}`
  ).join(" | ");

  const delivery=299, upfront=200, codRate=0.07;
  const productsTotal=cart.reduce((s,c)=>s+c.total,0);
  const grand=Math.round(productsTotal+delivery+((productsTotal+delivery)*codRate)-upfront);

  document.getElementById("order_number").value = orderNo;
  document.getElementById("order_details").value = details;
  document.getElementById("grand_total").value = "PKR " + grand;
}

renderCart();
</script>

</body>
</html>
